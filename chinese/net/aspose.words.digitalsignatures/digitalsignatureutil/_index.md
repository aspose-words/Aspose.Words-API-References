---
title: DigitalSignatureUtil
second_title: Aspose.Words for .NET API 参考
description: 提供签署文件的方法
type: docs
weight: 400
url: /zh/net/aspose.words.digitalsignatures/digitalsignatureutil/
---
## DigitalSignatureUtil class

提供签署文件的方法。

```csharp
public static class DigitalSignatureUtil
```

## 方法

| 姓名 | 描述 |
| --- | --- |
| static [LoadSignatures](../../aspose.words.digitalsignatures/digitalsignatureutil/loadsignatures#loadsignatures)(Stream) | 使用流从文档中加载数字签名。 |
| static [LoadSignatures](../../aspose.words.digitalsignatures/digitalsignatureutil/loadsignatures#loadsignatures_1)(string) | 从文档加载数字签名。 |
| static [RemoveAllSignatures](../../aspose.words.digitalsignatures/digitalsignatureutil/removeallsignatures#removeallsignatures)(Stream, Stream) | 从源流中的文档中删除所有数字签名，并将未签名的文档写入目标流。 |
| static [RemoveAllSignatures](../../aspose.words.digitalsignatures/digitalsignatureutil/removeallsignatures#removeallsignatures_1)(string, string) | 从源文件中删除所有数字签名并将未签名的文件写入目标文件。 |
| static [Sign](../../aspose.words.digitalsignatures/digitalsignatureutil/sign#sign)(Stream, Stream, CertificateHolder) | 使用给定[`CertificateHolder`](../certificateholder)与数字签名 签署源文档并写入已签名文档到目标流。 |
| static [Sign](../../aspose.words.digitalsignatures/digitalsignatureutil/sign#sign_2)(string, string, CertificateHolder) | 使用给定[`CertificateHolder`](../certificateholder)与数字签名 签署源文档并写入已签名文档到目标文件。 |
| static [Sign](../../aspose.words.digitalsignatures/digitalsignatureutil/sign#sign_1)(Stream, Stream, CertificateHolder, SignOptions) | 使用给定的[`CertificateHolder`](../certificateholder)和SignOptions 带有数字签名并将签名文档写入目标流。 |
| static [Sign](../../aspose.words.digitalsignatures/digitalsignatureutil/sign#sign_3)(string, string, CertificateHolder, SignOptions) | 使用给定的[`CertificateHolder`](../certificateholder)和SignOptions 带有数字签名并将签名文档写入目标文件。 |

### 评论

由于数字签名适用于文件内容而不是文档对象模型，因此这些方法被放入单独的班级。

支持的格式有Doc和LoadFormat。文档。

### 例子

显示如何从数字签名文档加载签名。

```csharp
 // 使用DigitalSignatureUtil类去除数字签名有两种方式
 // 通过将未签名的副本保存在本地文件系统的其他位置来从已签名的文档中获取。
 // 1 - 通过文件名字符串确定签名文档和未签名副本的位置：
DigitalSignatureUtil.RemoveAllSignatures(MyDir + "Digitally signed.docx",
    ArtifactsDir + "DigitalSignatureUtil.LoadAndRemove.FromString.docx");

 // 2 - 通过文件流确定签名文档和未签名副本的位置：
using (Stream streamIn = new FileStream(MyDir + "Digitally signed.docx", FileMode.Open))
{
    using (Stream streamOut = new FileStream(ArtifactsDir + "DigitalSignatureUtil.LoadAndRemove.FromStream.docx", FileMode.Create))
    {
        DigitalSignatureUtil.RemoveAllSignatures(streamIn, streamOut);
    }
}

 // 验证我们的两个输出文档都没有数字签名。
Assert.That(DigitalSignatureUtil.LoadSignatures(ArtifactsDir + "DigitalSignatureUtil.LoadAndRemove.FromString.docx"), Is.Empty);
Assert.That(DigitalSignatureUtil.LoadSignatures(ArtifactsDir + "DigitalSignatureUtil.LoadAndRemove.FromStream.docx"), Is.Empty);
```

显示如何从数字签名文档中删除数字签名。

```csharp
 // 使用DigitalSignatureUtil类去除数字签名有两种方式
 // 通过将未签名的副本保存在本地文件系统的其他位置来从已签名的文档中获取。
 // 1 - 通过文件名字符串确定签名文档和未签名副本的位置：
DigitalSignatureUtil.RemoveAllSignatures(MyDir + "Digitally signed.docx",
    ArtifactsDir + "DigitalSignatureUtil.LoadAndRemove.FromString.docx");

 // 2 - 通过文件流确定签名文档和未签名副本的位置：
using (Stream streamIn = new FileStream(MyDir + "Digitally signed.docx", FileMode.Open))
{
    using (Stream streamOut = new FileStream(ArtifactsDir + "DigitalSignatureUtil.LoadAndRemove.FromStream.docx", FileMode.Create))
    {
        DigitalSignatureUtil.RemoveAllSignatures(streamIn, streamOut);
    }
}

 // 验证我们的两个输出文档都没有数字签名。
Assert.That(DigitalSignatureUtil.LoadSignatures(ArtifactsDir + "DigitalSignatureUtil.LoadAndRemove.FromString.docx"), Is.Empty);
Assert.That(DigitalSignatureUtil.LoadSignatures(ArtifactsDir + "DigitalSignatureUtil.LoadAndRemove.FromStream.docx"), Is.Empty);
```

### 也可以看看

* 命名空间 [Aspose.Words.DigitalSignatures](../../aspose.words.digitalsignatures)
* 部件 [Aspose.Words](../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Words.dll -->
