---
title: GetFieldCode
second_title: Aspose.Words for .NET API 参考
description: 返回字段开始和字段分隔符之间的文本如果没有分隔符则返回字段结束 包含子字段的字段代码和字段结果
type: docs
weight: 110
url: /zh/net/aspose.words.fields/field/getfieldcode/
---
## GetFieldCode() {#getfieldcode}

返回字段开始和字段分隔符之间的文本（如果没有分隔符，则返回字段结束）。 包含子字段的字段代码和字段结果。

```csharp
public string GetFieldCode()
```

### 例子

显示如何使用域代码将域插入到文档中。

```csharp
// 打开一个在 IF 字段中包含 MERGEFIELD 的文档。
Document doc = new Document(MyDir + "Nested fields.docx");
FieldIf fieldIf = (FieldIf)doc.Range.Fields[0];

// 获取字段的字段码有两种方式：
// 1 - 省略其内部字段：
Assert.AreEqual(" IF  > 0 \" (surplus of ) \" \"\" ", fieldIf.GetFieldCode(false));

// 2 - 包括其内部字段：
Assert.AreEqual($" IF \u0013 MERGEFIELD NetIncome \u0014\u0015 > 0 \" (surplus of \u0013 MERGEFIELD  NetIncome \\f $ \u0014\u0015) \" \"\" ",
    fieldIf.GetFieldCode(true));

// 默认情况下，GetFieldCode 方法显示内部字段。
Assert.AreEqual(fieldIf.GetFieldCode(), fieldIf.GetFieldCode(true));
```

显示如何获取字段的字段代码。

```csharp
// 打开一个在 IF 字段中包含 MERGEFIELD 的文档。
Document doc = new Document(MyDir + "Nested fields.docx");
FieldIf fieldIf = (FieldIf)doc.Range.Fields[0];

// 获取字段的字段码有两种方式：
// 1 - 省略其内部字段：
Assert.AreEqual(" IF  > 0 \" (surplus of ) \" \"\" ", fieldIf.GetFieldCode(false));

// 2 - 包括其内部字段：
Assert.AreEqual($" IF \u0013 MERGEFIELD NetIncome \u0014\u0015 > 0 \" (surplus of \u0013 MERGEFIELD  NetIncome \\f $ \u0014\u0015) \" \"\" ",
    fieldIf.GetFieldCode(true));

// 默认情况下，GetFieldCode 方法显示内部字段。
Assert.AreEqual(fieldIf.GetFieldCode(), fieldIf.GetFieldCode(true));
```

### 也可以看看

* class [Field](../../field)
* 命名空间 [Aspose.Words.Fields](../../field)
* 部件 [Aspose.Words](../../../)

---

## GetFieldCode(bool) {#getfieldcode_1}

返回字段开始和字段分隔符之间的文本（如果没有分隔符，则返回字段结束）。

```csharp
public string GetFieldCode(bool includeChildFieldCodes)
```

| 范围 | 类型 | 描述 |
| --- | --- | --- |
| includeChildFieldCodes | Boolean | ` True` 如果应包含子字段代码。 |

### 例子

显示如何获取字段的字段代码。

```csharp
// 打开一个在 IF 字段中包含 MERGEFIELD 的文档。
Document doc = new Document(MyDir + "Nested fields.docx");
FieldIf fieldIf = (FieldIf)doc.Range.Fields[0];

// 获取字段的字段码有两种方式：
// 1 - 省略其内部字段：
Assert.AreEqual(" IF  > 0 \" (surplus of ) \" \"\" ", fieldIf.GetFieldCode(false));

// 2 - 包括其内部字段：
Assert.AreEqual($" IF \u0013 MERGEFIELD NetIncome \u0014\u0015 > 0 \" (surplus of \u0013 MERGEFIELD  NetIncome \\f $ \u0014\u0015) \" \"\" ",
    fieldIf.GetFieldCode(true));

// 默认情况下，GetFieldCode 方法显示内部字段。
Assert.AreEqual(fieldIf.GetFieldCode(), fieldIf.GetFieldCode(true));
```

### 也可以看看

* class [Field](../../field)
* 命名空间 [Aspose.Words.Fields](../../field)
* 部件 [Aspose.Words](../../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Words.dll -->
