---
title: MappedDataFieldCollection
second_title: Aspose.Words for .NET API 参考
description: 允许在数据源 中的字段名称和文档中的邮件合并字段名称之间自动映射
type: docs
weight: 3600
url: /zh/net/aspose.words.mailmerging/mappeddatafieldcollection/
---
## MappedDataFieldCollection class

允许在数据源 中的字段名称和文档中的邮件合并字段名称之间自动映射。

```csharp
public class MappedDataFieldCollection : IEnumerable<KeyValuePair<string, string>>
```

## 特性

| 姓名 | 描述 |
| --- | --- |
| [Count](../../aspose.words.mailmerging/mappeddatafieldcollection/count) { get; } | 获取集合中包含的元素数。 |
| [Item](../../aspose.words.mailmerging/mappeddatafieldcollection/item) { get; set; } | 获取或设置与指定邮件合并字段关联的数据源中的字段名称。 |

## 方法

| 姓名 | 描述 |
| --- | --- |
| [Add](../../aspose.words.mailmerging/mappeddatafieldcollection/add)(string, string) | 添加一个新的字段映射。 |
| [Clear](../../aspose.words.mailmerging/mappeddatafieldcollection/clear)() | 从集合中删除所有元素。 |
| [ContainsKey](../../aspose.words.mailmerging/mappeddatafieldcollection/containskey)(string) | 确定集合中是否存在来自文档中指定字段的映射。 |
| [ContainsValue](../../aspose.words.mailmerging/mappeddatafieldcollection/containsvalue)(string) | 确定集合中是否存在来自数据源中指定字段的映射。 |
| [GetEnumerator](../../aspose.words.mailmerging/mappeddatafieldcollection/getenumerator)() | 返回一个字典枚举器对象，可用于迭代集合中的所有项目。 |
| [Remove](../../aspose.words.mailmerging/mappeddatafieldcollection/remove)(string) | 删除字段映射。 |

### 评论

这被实现为字符串键的集合到字符串值。 键是文档中邮件合并字段的名称，值 是数据源中的字段名称。

### 例子

显示如何映射具有不同名称的数据列和 MERGEFIELD，以便在邮件合并期间在它们之间传输数据。

```csharp
public void MappedDataFieldCollection()
{
    Document doc = CreateSourceDocMappedDataFields();
    DataTable dataTable = CreateSourceTableMappedDataFields();

     // 该表有一个名为“Column2”的列，但没有具有该名称的 MERGEFIELD。
     // 另外，我们有一个名为“Column3”的 MERGEFIELD，但数据源没有该名称的列。
     // 如果“Column2”中的数据适合“Column3” MERGEFIELD,
     // 我们可以将该列名映射到“MappedDataFields”键/值对中的 MERGEFIELD。
    MappedDataFieldCollection mappedDataFields = doc.MailMerge.MappedDataFields;

     // 我们可以像这样将数据源列名称链接到 MERGEFIELD 名称。
    mappedDataFields.Add("MergeFieldName", "DataSourceColumnName");

     // 将名为“Column2”的数据源列链接到名为“Column3”的MERGEFIELDs.
    mappedDataFields.Add("Column3", "Column2");

     // MERGEFIELD 名称是相应数据源列名称“值”的“键”。
    Assert.AreEqual("DataSourceColumnName", mappedDataFields["MergeFieldName"]);
    Assert.True(mappedDataFields.ContainsKey("MergeFieldName"));
    Assert.True(mappedDataFields.ContainsValue("DataSourceColumnName"));

     // 现在如果我们运行这个邮件合并，“Column3”MERGEFIELDs 将从表的“Column2”获取数据。
    doc.MailMerge.Execute(dataTable);

    doc.Save(ArtifactsDir + "MailMerge.MappedDataFieldCollection.docx");

    // 我们可以遍历这个集合中的元素。
    Assert.AreEqual(2, mappedDataFields.Count);

    using (IEnumerator<KeyValuePair<string, string>> enumerator = mappedDataFields.GetEnumerator())
        while (enumerator.MoveNext())
            Console.WriteLine(
                $"Column named {enumerator.Current.Value} is mapped to MERGEFIELDs named {enumerator.Current.Key}");

     // 我们也可以从集合中移除元素。
    mappedDataFields.Remove("MergeFieldName");

    Assert.False(mappedDataFields.ContainsKey("MergeFieldName"));
    Assert.False(mappedDataFields.ContainsValue("DataSourceColumnName"));

    mappedDataFields.Clear();

    Assert.AreEqual(0, mappedDataFields.Count);
}

/// <summary>
 /// 创建一个包含 2 个 MERGEFIELD 的文档，其中一个没有 a
 /// 来自下面方法的数据表中对应的列.
/// </summary>
private static Document CreateSourceDocMappedDataFields()
{
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    builder.InsertField(" MERGEFIELD Column1");
    builder.Write(", ");
    builder.InsertField(" MERGEFIELD Column3");

    return doc;
}

/// <summary>
 /// 创建一个2列的数据表，其中一列没有a
 /// 以上方法对应源文档中的MERGEFIELD.
/// </summary>
private static DataTable CreateSourceTableMappedDataFields()
{
    DataTable dataTable = new DataTable("MyTable");
    dataTable.Columns.Add("Column1");
    dataTable.Columns.Add("Column2");
    dataTable.Rows.Add(new object[] { "Value1", "Value2" });

    return dataTable;
}
```

### 也可以看看

* namespace [Aspose.Words.MailMerging](../../aspose.words.mailmerging)
* assembly [Aspose.Words](../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Words.dll -->
