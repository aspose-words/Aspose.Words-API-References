---
title: JoinRunsWithSameFormatting
second_title: Aspose.Words for .NET API 参考
description: 以段落中相同的格式连接运行
type: docs
weight: 280
url: /zh/net/aspose.words/paragraph/joinrunswithsameformatting/
---
## Paragraph.JoinRunsWithSameFormatting method

以段落中相同的格式连接运行。

```csharp
public int JoinRunsWithSameFormatting()
```

### 返回值

执行的连接数。当 **N** 相邻运行被加入时，它们计为 **N - 1** 加入。

### 例子

显示如何通过合并多余的运行来简化段落。

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

 // 在段落中插入四行文本。
builder.Write("Run 1. ");
builder.Write("Run 2. ");
builder.Write("Run 3. ");
builder.Write("Run 4. ");

 // 如果我们在 Microsoft Word 中打开此文档，该段落将看起来像一个无缝的文本正文。
 // 但是，它将由具有相同格式的四个单独的运行组成。像this
这样的分段段落
// 当我们在 Microsoft Word 中多次手动编辑一个段落的部分时可能会发生。
Paragraph para = builder.CurrentParagraph;

Assert.AreEqual(4, para.Runs.Count);

 // 更改上次运行的样式，使其与前三个不同。
para.Runs[3].Font.StyleIdentifier = StyleIdentifier.Emphasis;

 // 我们可以运行“JoinRunsWithSameFormatting”方法来优化文档的内容
// 通过将相似的运行合并为一个，减少它们的总数。
 // 此方法还返回此方法合并的运行次数。
 // 这两个合并发生在合并 Runs #1、#2 和 #3,
 // 同时省略 Run #4，因为它的样式不兼容。
Assert.AreEqual(2, para.JoinRunsWithSameFormatting());

 // 剩下的运行次数将等于原始 count
 // 减去“JoinRunsWithSameFormatting”方法执行的运行合并次数。
Assert.AreEqual(2, para.Runs.Count);
Assert.AreEqual("Run 1. Run 2. Run 3. ", para.Runs[0].Text);
Assert.AreEqual("Run 4. ", para.Runs[1].Text);
```

### 也可以看看

* class [Paragraph](../../paragraph)
* 命名空间 [Aspose.Words](../../paragraph)
* 部件 [Aspose.Words](../../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Words.dll -->
