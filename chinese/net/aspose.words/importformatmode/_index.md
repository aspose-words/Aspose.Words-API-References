---
title: ImportFormatMode
second_title: Aspose.Words for .NET API 参考
description: 指定从另一个文档导入内容时如何合并格式
type: docs
weight: 2980
url: /zh/net/aspose.words/importformatmode/
---
## ImportFormatMode enumeration

指定从另一个文档导入内容时如何合并格式。

```csharp
public enum ImportFormatMode
```

### 价值观

| 姓名 | 价值 | 描述 |
| --- | --- | --- |
| UseDestinationStyles | `0` | 使用目标文档样式并复制新样式。这是默认选项。 |
| KeepSourceFormatting | `1` | 将所有需要的样式复制到目标文档，如果需要，生成唯一的样式名称。 |
| KeepDifferentStyles | `2` | 仅复制与源文档中不同的样式。 |

### 评论

当您将节点从一个文档复制到另一个文档时，此选项指定如何格式化 当两个文档具有相同名称但格式不同的样式时解决。

格式解析如下:

1. Built -in 样式使用与区域设置无关的样式标识符进行匹配。 用户定义的样式使用区分大小写的样式名称进行匹配。
2. 如果在目标文档中找不到匹配的样式，则将样式 （以及它引用的所有样式）复制到目标文档 并更新导入的节点以引用新样式。
3. 如果目标文档中已经存在匹配的样式，会发生什么 取决于` importFormatMode` 参数传递给 [`Document.ImportNode`](../documentbase/importnode) 如下所述。

当使用 **UseDestinationStyles** 选项时，如果匹配样式已存在 在目标文档中，样式不会被复制，导入的节点会更新 以引用现有样式。

使用 **UseDestinationStyles** 的缺点是导入的文本可能 与源文档相比，目标文档中的外观有所不同。 例如，源文档中的“标题 1”样式使用 Arial 16pt 字体，而 目标文档中的“标题 1”样式使用 Times New Roman 14pt 字体。 当导入没有其他直接格式的“标题 1”样式的文本时，它将 在目标文档中显示为 Times New Roman 14pt 字体。

**KeepSourceFormatting** 选项允许确保导入的内容看起来相同 在目标文档中就像在源文档中一样。 如果目标文档中已经存在匹配的样式，则源样式格式将 扩展为直接 Node 属性，并将样式更改为 Normal。 如果目标文档中不存在该样式，则将源样式导入 到目标文档中并应用于导入的节点。 请注意，即使源样式不存在于目标文档中，也不总是可以保留源样式。 在这种情况下，这种样式的格式将扩展为直接节点属性，以支持保留原始节点格式。

使用 **KeepSourceFormatting** 的缺点是，如果您执行多个导入， 您最终可能会在目标文档中使用许多样式，这可能会使该文档难以在 Microsoft Word 中使用 一致的样式格式。

使用 **KeepDifferentStyles** 选项允许重用目标样式 如果格式化它们提供的样式与源文档中的样式相同。 如果目标文档中的样式与源文档中的样式不同，则将其导入。

### 例子

显示如何将文档插入到另一个文档中。

```csharp
Document doc = new Document(MyDir + "Document.docx");

DocumentBuilder builder = new DocumentBuilder(doc);
builder.MoveToDocumentEnd();
builder.InsertBreak(BreakType.PageBreak);

Document docToInsert = new Document(MyDir + "Formatted elements.docx");

builder.InsertDocument(docToInsert, ImportFormatMode.KeepSourceFormatting);
builder.Document.Save(ArtifactsDir + "DocumentBuilder.InsertDocument.docx");
```

### 也可以看看

* namespace [Aspose.Words](../../aspose.words)
* assembly [Aspose.Words](../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Words.dll -->
