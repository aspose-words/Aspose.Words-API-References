---
title: WebRequestTimeout
second_title: Aspose.Words for .NET API 参考
description: Web 请求超时前等待的毫秒数默认值为 100000 毫秒 100 秒
type: docs
weight: 70
url: /zh/net/aspose.words.loading/htmlloadoptions/webrequesttimeout/
---
## HtmlLoadOptions.WebRequestTimeout property

Web 请求超时前等待的毫秒数。默认值为 100000 毫秒 (100 秒)。

```csharp
public int WebRequestTimeout { get; set; }
```

### 评论

Aspose.Words 在加载外部资源（图像、 style sheet) 在 HTML 和 MHTML 文档中链接。

### 例子

展示了在加载带有通过 URL 链接的外部资源的文档时如何设置 Web 请求的时间限制。

```csharp
public void WebRequestTimeout()
{
    // 创建一个新的 HtmlLoadOptions 对象并验证其对 Web 请求的超时阈值。
    HtmlLoadOptions options = new HtmlLoadOptions();

     // 当加载一个 Html 文档时，通过一个网址 URL 外部链接的资源，
     // Aspose.Words 将中止在此时间限制内未能获取资源的 Web 请求，以毫秒为单位。
    Assert.AreEqual(100000, options.WebRequestTimeout);

     // 设置一个WarningCallback，它将记录加载过程中发生的所有警告。
    ListDocumentWarnings warningCallback = new ListDocumentWarnings();
    options.WarningCallback = warningCallback;

     // 加载这样的文档并验证是否已创建了带有图像数据的形状。
     // 这个链接的图像需要一个网络请求来加载，它必须在我们的时间限制内完成。
    string html = $@"
        <html>
            <img src=""{ImageUrl}"" alt=""Aspose logo"" style=""width:400px;height:400px;"">
        </html>
    ";

    Document doc = new Document(new MemoryStream(Encoding.UTF8.GetBytes(html)), options);
    Shape imageShape = (Shape)doc.GetChild(NodeType.Shape, 0, true);

    Assert.AreEqual(1109843, imageShape.ImageData.ImageBytes.Length);
    Assert.AreEqual(0, warningCallback.Warnings().Count);

     // 设置不合理的超时限制并尝试再次加载文档。
    options.WebRequestTimeout = 0;
    doc = new Document(new MemoryStream(Encoding.UTF8.GetBytes(html)), options);

     // 超时获取图片失败的web请求依然会产生图片.
     // 但是，图像将是通常表示丢失图像的红色“x”。
    imageShape = (Shape)doc.GetChild(NodeType.Shape, 0, true);
    Assert.AreEqual(924, imageShape.ImageData.ImageBytes.Length);

    // 我们还可以配置自定义回调以从超时的 Web 请求中获取任何警告。
    Assert.AreEqual(WarningSource.Html, warningCallback.Warnings()[0].Source);
    Assert.AreEqual(WarningType.DataLoss, warningCallback.Warnings()[0].WarningType);
    Assert.AreEqual($"Couldn't load a resource from \'{ImageUrl}\'.", warningCallback.Warnings()[0].Description);

    Assert.AreEqual(WarningSource.Html, warningCallback.Warnings()[1].Source);
    Assert.AreEqual(WarningType.DataLoss, warningCallback.Warnings()[1].WarningType);
    Assert.AreEqual("Image has been replaced with a placeholder.", warningCallback.Warnings()[1].Description);

    doc.Save(ArtifactsDir + "HtmlLoadOptions.WebRequestTimeout.docx");
}

/// <summary>
 /// 将文档加载操作期间发生的所有警告存储在 List.
 中
/// </summary>
private class ListDocumentWarnings : IWarningCallback
{
    public void Warning(WarningInfo info)
    {
        mWarnings.Add(info);
    }

    public List<WarningInfo> Warnings() { 
        return mWarnings;
    }

    private readonly List<WarningInfo> mWarnings = new List<WarningInfo>();
}
```

### 也可以看看

* class [HtmlLoadOptions](../../htmlloadoptions)
* namespace [Aspose.Words.Loading](../../htmlloadoptions)
* assembly [Aspose.Words](../../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Words.dll -->
