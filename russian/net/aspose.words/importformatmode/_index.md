---
title: ImportFormatMode
second_title: Справочник по API Aspose.Words для .NET
description: Указывает как форматирование объединяется при импорте содержимого из другого документа.
type: docs
weight: 2980
url: /ru/net/aspose.words/importformatmode/
---
## ImportFormatMode enumeration

Указывает, как форматирование объединяется при импорте содержимого из другого документа.

```csharp
public enum ImportFormatMode
```

### Ценности

| Имя | Ценность | Описание |
| --- | --- | --- |
| UseDestinationStyles | `0` | Используйте стили целевого документа и скопируйте новые стили. Это опция по умолчанию. |
| KeepSourceFormatting | `1` | Скопируйте все необходимые стили в целевой документ, при необходимости создайте уникальные имена стилей. |
| KeepDifferentStyles | `2` | Копировать только стили, отличные от тех, что в исходном документе. |

### Примечания

Когда вы копируете узлы из одного документа в другой, эта опция определяет способ форматирования разрешается, когда оба документа имеют стиль с одинаковым именем, но разным форматированием.

Форматирование разрешается следующим образом:

Встроенный -in стили сопоставляются с использованием идентификатора стиля, независимого от языкового стандарта. Определенные пользователем стили сопоставляются с использованием имени стиля с учетом регистра.

Если соответствующий стиль не найден в целевом документе, стиль (и все стили, на которые он ссылается) копируется в целевой document и импортированные узлы обновляются, чтобы ссылаться на новый стиль.

Если соответствующий стиль уже существует в целевом документе, что происходит зависит от` importFormatMode`Параметр передается в [`Document.ImportNode`](../documentbase/importnode) как описано ниже.

При использовании параметра **UseDestinationStyles** , если соответствующий стиль уже существует в целевом документе, стиль не копируется, а импортированные узлы обновляются для ссылки на существующий стиль.

Недостаток использования **UseDestinationStyles** заключается в том, что импортированный текст может выглядят иначе в целевом документе по сравнению с исходным документом. Например, стиль «Заголовок 1» в исходном документе использует шрифт Arial 16pt, а стиль «Заголовок 1» в целевом документе использует шрифт Times New Roman 14pt. При импорте текста стиля "Заголовок 1" без другого прямого форматирования он будет отображаться как шрифт Times New Roman 14pt в целевом документе.

**KeepSourceFormatting** позволяет убедиться, что импортируемый контент выглядит одинаково в целевом документе, как это выглядит в исходном документе. Если соответствующий стиль уже существует в целевом документе, форматирование исходного стиля расширяется до непосредственных атрибутов узла, а стиль изменяется на Обычный. Если стиль не существует в целевом документе, то исходный стиль импортируется в целевой документ и применяется к импортированному узлу. Обратите внимание, что не всегда возможно сохранить исходный стиль, даже если он не существует в целевом документе. В этом случае форматирование такого стиля будет расширено на прямые атрибуты Node в пользу сохранения исходного форматирования Node.

Недостаток использования **KeepSourceFormatting** заключается в том, что при выполнении нескольких импортов в целевом документе может оказаться много стилей, что может затруднить использование форматирования в Microsoft Word для этого документа.

Использование **KeepDifferentStyles** позволяет повторно использовать целевые стили если форматирование они обеспечивают идентичные стили в исходном документе. Если стиль в целевом документе отличается от исходного, то он импортируется.

:

### Примеры

Показывает, как вставить документ в другой документ.

```csharp
Document doc = new Document(MyDir + "Document.docx");

DocumentBuilder builder = new DocumentBuilder(doc);
builder.MoveToDocumentEnd();
builder.InsertBreak(BreakType.PageBreak);

Document docToInsert = new Document(MyDir + "Formatted elements.docx");

builder.InsertDocument(docToInsert, ImportFormatMode.KeepSourceFormatting);
builder.Document.Save(ArtifactsDir + "DocumentBuilder.InsertDocument.docx");
```

### Смотрите также

* пространство имен [Aspose.Words](../../aspose.words)
* сборка [Aspose.Words](../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Words.dll -->
