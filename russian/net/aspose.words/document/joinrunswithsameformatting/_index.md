---
title: Document.JoinRunsWithSameFormatting
second_title: Справочник по API Aspose.Words для .NET
description: Document метод. Объединяет прогоны с одинаковым форматированием во всех абзацах документа.
type: docs
weight: 600
url: /ru/net/aspose.words/document/joinrunswithsameformatting/
---
## Document.JoinRunsWithSameFormatting method

Объединяет прогоны с одинаковым форматированием во всех абзацах документа.

```csharp
public int JoinRunsWithSameFormatting()
```

### Возвращаемое значение

Количество выполненных объединений. Когда **Н** соединяются соседние прогоны, они считаются **Н - 1** присоединяется.

### Примечания

Это метод оптимизации. Некоторые документы содержат смежные прогоны с одинаковым форматированием. Обычно это происходит, если документ интенсивно редактировался вручную. Вы можете уменьшить размер документа и ускорить дальнейшую обработку, объединив эти прогоны.

Операция проверяет каждый[`Paragraph`](../../paragraph/) узел в документе для смежных[`Run`](../../run/) узлов с одинаковыми свойствами. Он игнорирует уникальные идентификаторы, используемые для отслеживания сеансов редактирования создания и модификации run . При первом запуске в каждой последовательности соединения накапливается весь текст. Оставшиеся прогоны удаляются из документа.

### Примеры

Показывает, как объединять прогоны в документе, чтобы уменьшить количество ненужных прогонов.

```csharp
// Открываем документ, содержащий смежные фрагменты текста с одинаковым форматированием,
// что обычно происходит, если мы редактируем один и тот же абзац несколько раз в Microsoft Word.
Document doc = new Document(MyDir + "Rendering.docx");

// Если какое-то количество этих прогонов рядом с одинаковым форматированием,
// то документ можно упростить.
Assert.AreEqual(317, doc.GetChildNodes(NodeType.Run, true).Count);

// Комбинируйте такие прогоны с этим методом и проверяйте, какое количество прогонов будет выполнено.
Assert.AreEqual(121, doc.JoinRunsWithSameFormatting());

// Количество объединений и количество прогонов, которые у нас есть после объединения
// должно суммироваться количество прогонов, которое у нас было изначально.
Assert.AreEqual(196, doc.GetChildNodes(NodeType.Run, true).Count);
```

### Смотрите также

* class [Document](../)
* пространство имен [Aspose.Words](../../document/)
* сборка [Aspose.Words](../../../)


